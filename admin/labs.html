<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lab Management - College Management System</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="labs.css">
</head>
<body>
    <div class="mobile-header">
        <div class="mobile-header-content">
            <div class="mobile-logo">
                ðŸ§ª <span>SCMS Labs</span>
            </div>
            <div class="mobile-controls">
                <button class="mobile-theme-toggle" onclick="toggleTheme()" title="Toggle Dark/Light Mode">
                    <i class="fas fa-moon" id="mobileThemeIcon"></i>
                </button>
                <button class="mobile-menu-btn" onclick="toggleMobileSidebar()">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
        </div>
    </div>

    <div class="sidebar-overlay" id="sidebarOverlay" onclick="closeMobileSidebar()"></div>

    <div class="dashboard">
        <div class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <h2>ðŸŽ“ SCMS</h2>
                <p>Admin Portal</p>
            </div>
            
            <div class="user-info" id="userInfo">
                <div class="user-avatar">
                    <i class="fas fa-user-shield"></i>
                </div>
                <div class="user-details">
                    <div class="user-name" id="userName">Loading...</div>
                    <div class="user-role">Lab Administrator</div>
                </div>
            </div>
            
            <div class="theme-toggle-sidebar" onclick="toggleTheme()">
                <div class="theme-toggle-icon">
                    <i class="fas fa-moon" id="themeIcon"></i>
                    <span id="themeLabel">Dark Mode</span>
                </div>
                <div class="theme-switch" id="themeSwitch">
                    <div class="theme-switch-handle"></div>
                </div>
            </div>
            
            <nav class="sidebar-nav">
                <ul>
                    <li>
                        <a href="dashboard.html">
                            <i class="fas fa-tachometer-alt"></i>
                            Dashboard
                        </a>
                    </li>
                    <li>
                        <a href="users.html">
                            <i class="fas fa-chalkboard-teacher"></i>
                            Class Management
                        </a>
                    </li>
                    <li>
                        <a href="students.html">
                            <i class="fas fa-user-graduate"></i>
                            Students
                        </a>
                    </li>
                    <li>
                        <a href="teachers.html">
                            <i class="fas fa-user-tie"></i>
                            Faculty
                        </a>
                    </li>
                    <li>
                        <a href="departments.html">
                            <i class="fas fa-building"></i>
                            Departments
                        </a>
                    </li>
                    <li>
                        <a href="labs.html">
                            <i class="fas fa-flask"></i>
                            Lab Management
                        </a>
                    </li>
                     <li>
                        <a href="feedback.html">
                            <i class="fas fa-comment-dots"></i>
                            Feedback & Complaints
                        </a>
                    </li>
                        
                    <li>
                        <a href="reports.html">
                            <i class="fas fa-chart-bar"></i>
                            Reports & Analytics
                        </a>
                    </li>
                    <li>
                        <a href="settings.html">
                            <i class="fas fa-cog"></i>
                            System Settings
                        </a>
                    </li>
                    <li>
                        <a href="#" onclick="logout()">
                            <i class="fas fa-sign-out-alt"></i>
                            Logout
                        </a>
                    </li>
                </ul>
            </nav>
        </div>
        
        <div class="main-content">
            <div class="header">
                <div>
                    <h1>ðŸ§ª Laboratory Management</h1>
                    <p>Manage laboratory facilities, equipment, and operations efficiently</p>
                </div>
                <div class="header-actions">
                    <button class="btn btn-success" onclick="openAddLabModal()">
                        <i class="fas fa-plus"></i>
                        Add New Lab
                    </button>
                    <button class="btn btn-primary" onclick="openLabBookingModal()">
                        <i class="fas fa-calendar-plus"></i>
                        Lab Booking
                    </button>
                    <button class="btn btn-warning" onclick="openMaintenanceModal()">
                        <i class="fas fa-tools"></i>
                        Maintenance
                    </button>
                    <button class="btn btn-secondary" onclick="exportLabData()">
                        <i class="fas fa-download"></i>
                        Export
                    </button>
                </div>
            </div>

            <!-- Lab Statistics Grid -->
            <div class="stats-grid">
                <div class="stat-card total">
                    <div class="stat-icon">
                        <i class="fas fa-flask"></i>
                    </div>
                    <div class="stat-info">
                        <div class="stat-number" id="totalLabs">28</div>
                        <div class="stat-label">Total Laboratories</div>
                        <div class="stat-change">+3 this month</div>
                    </div>
                </div>
                
                <div class="stat-card active">
                    <div class="stat-icon">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <div class="stat-info">
                        <div class="stat-number" id="activeLabs">25</div>
                        <div class="stat-label">Active Labs</div>
                        <div class="stat-change">89% operational</div>
                    </div>
                </div>
                
                <div class="stat-card capacity">
                    <div class="stat-icon">
                        <i class="fas fa-users"></i>
                    </div>
                    <div class="stat-info">
                        <div class="stat-number" id="totalCapacity">850</div>
                        <div class="stat-label">Total Capacity</div>
                        <div class="stat-change">Students</div>
                    </div>
                </div>
                
                <div class="stat-card utilization">
                    <div class="stat-icon">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <div class="stat-info">
                        <div class="stat-number" id="avgUtilization">76%</div>
                        <div class="stat-label">Avg Utilization</div>
                        <div class="stat-change">This week</div>
                    </div>
                </div>
            </div>

            <!-- Lab Activity Overview -->
            <div class="activity-section">
                <div class="activity-header">
                    <h3><i class="fas fa-activity"></i> Today's Lab Activities</h3>
                    <div class="activity-controls">
                        <button class="btn btn-sm btn-primary" onclick="refreshActivities()">
                            <i class="fas fa-sync-alt"></i>
                            Refresh
                        </button>
                        <button class="btn btn-sm btn-secondary" onclick="viewAllActivities()">
                            <i class="fas fa-eye"></i>
                            View All
                        </button>
                    </div>
                </div>
                <div class="activity-grid">
                    <div class="activity-card ongoing">
                        <div class="activity-status">
                            <i class="fas fa-play-circle"></i>
                            <span>Ongoing</span>
                        </div>
                        <div class="activity-details">
                            <h4>Programming Lab - CSE Block</h4>
                            <p>Data Structures & Algorithms</p>
                            <div class="activity-meta">
                                <span><i class="fas fa-clock"></i> 10:00 AM - 12:00 PM</span>
                                <span><i class="fas fa-users"></i> 28/30 Students</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="activity-card scheduled">
                        <div class="activity-status">
                            <i class="fas fa-calendar-check"></i>
                            <span>Scheduled</span>
                        </div>
                        <div class="activity-details">
                            <h4>Electronics Lab - ECE Block</h4>
                            <p>Digital Circuit Design</p>
                            <div class="activity-meta">
                                <span><i class="fas fa-clock"></i> 2:00 PM - 4:00 PM</span>
                                <span><i class="fas fa-users"></i> 0/25 Students</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="activity-card maintenance">
                        <div class="activity-status">
                            <i class="fas fa-tools"></i>
                            <span>Maintenance</span>
                        </div>
                        <div class="activity-details">
                            <h4>Chemistry Lab - Science Block</h4>
                            <p>Equipment Calibration</p>
                            <div class="activity-meta">
                                <span><i class="fas fa-clock"></i> 1:00 PM - 3:00 PM</span>
                                <span><i class="fas fa-user-cog"></i> Tech Team</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Filters Section -->
            <div class="filters-section">
                <div class="search-box">
                    <input type="text" class="search-input" placeholder="Search labs by name, type, or equipment..." 
                           id="searchInput" onkeyup="searchLabs()">
                    <i class="fas fa-search search-icon"></i>
                </div>
                
                <select class="filter-select" id="departmentFilter" onchange="filterLabs()">
                    <option value="">All Departments</option>
                    <option value="CSE">Computer Science</option>
                    <option value="ECE">Electronics</option>
                    <option value="MECH">Mechanical</option>
                    <option value="CIVIL">Civil</option>
                    <option value="IT">Information Technology</option>
                    <option value="PHY">Physics</option>
                    <option value="CHEM">Chemistry</option>
                </select>
                
                <select class="filter-select" id="typeFilter" onchange="filterLabs()">
                    <option value="">All Lab Types</option>
                    <option value="Computer Lab">Computer Lab</option>
                    <option value="Electronics Lab">Electronics Lab</option>
                    <option value="Workshop Lab">Workshop Lab</option>
                    <option value="Chemistry Lab">Chemistry Lab</option>
                    <option value="Physics Lab">Physics Lab</option>
                    <option value="Research Lab">Research Lab</option>
                </select>

                <select class="filter-select" id="statusFilter" onchange="filterLabs()">
                    <option value="">All Status</option>
                    <option value="active">Active</option>
                    <option value="maintenance">Under Maintenance</option>
                    <option value="inactive">Inactive</option>
                    <option value="booked">Currently Booked</option>
                </select>

                <select class="filter-select" id="utilizationFilter" onchange="filterLabs()">
                    <option value="">All Utilization</option>
                    <option value="high">High (>80%)</option>
                    <option value="medium">Medium (50-80%)</option>
                    <option value="low">Low (<50%)</option>
                </select>
            </div>

            <!-- Bulk Actions -->
            <div class="bulk-actions" id="bulkActions">
                <input type="checkbox" id="selectAllLabs" onchange="toggleSelectAllLabs()">
                <span class="selected-count" id="selectedLabCount">0 labs selected</span>
                <button class="btn btn-warning btn-sm" onclick="bulkLabAction('maintenance')">
                    <i class="fas fa-tools"></i>
                    Schedule Maintenance
                </button>
                <button class="btn btn-success btn-sm" onclick="bulkLabAction('activate')">
                    <i class="fas fa-check"></i>
                    Activate Labs
                </button>
                <button class="btn btn-primary btn-sm" onclick="exportSelectedLabs()">
                    <i class="fas fa-download"></i>
                    Export Selected
                </button>
            </div>

            <!-- Labs Grid Section -->
            <div class="labs-section">
                <div class="table-header">
                    <h3><i class="fas fa-flask"></i> Laboratory Directory</h3>
                    <div class="view-controls">
                        <button class="btn btn-sm active" id="cardViewBtn" onclick="switchLabView('card')" title="Card View">
                            <i class="fas fa-th-large"></i>
                        </button>
                        <button class="btn btn-sm" id="tableViewBtn" onclick="switchLabView('table')" title="Table View">
                            <i class="fas fa-table"></i>
                        </button>
                        <button class="btn btn-primary btn-sm" onclick="refreshLabs()">
                            <i class="fas fa-sync-alt"></i>
                            Refresh
                        </button>
                    </div>
                </div>

                <!-- Card View -->
                <div class="labs-container" id="labsContainer">
                    <!-- Lab cards will be populated here by JavaScript -->
                </div>

                <!-- Table View -->
                <div class="table-container" id="labTableContainer" style="display: none;">
                    <table>
                        <thead>
                            <tr>
                                <th><input type="checkbox" id="masterLabCheckbox" onchange="toggleMasterLabCheckbox()"></th>
                                <th>Lab Information</th>
                                <th>Department</th>
                                <th>Capacity & Utilization</th>
                                <th>Equipment Status</th>
                                <th>In-charge</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="labsTableBody">
                            <!-- Table rows will be populated here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Lab Modal -->
    <div class="modal" id="addLabModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="labModalTitle">Add New Laboratory</h3>
                <button class="close-btn" onclick="closeModal()">&times;</button>
            </div>
            <form id="labForm" onsubmit="saveLab(event)">
                <div class="form-section">
                    <h4><i class="fas fa-flask"></i> Basic Information</h4>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label>Lab Name *</label>
                            <input type="text" id="labName" required placeholder="Programming Lab">
                        </div>
                        
                        <div class="form-group">
                            <label>Lab Code *</label>
                            <input type="text" id="labCode" required placeholder="CSE-LAB-001">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label>Lab Type *</label>
                            <select id="labType" required>
                                <option value="">Select Lab Type</option>
                                <option value="Computer Lab">Computer Lab</option>
                                <option value="Electronics Lab">Electronics Lab</option>
                                <option value="Workshop Lab">Workshop Lab</option>
                                <option value="Chemistry Lab">Chemistry Lab</option>
                                <option value="Physics Lab">Physics Lab</option>
                                <option value="Research Lab">Research Lab</option>
                                <option value="Language Lab">Language Lab</option>
                                <option value="CAD Lab">CAD Lab</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label>Department *</label>
                            <select id="labDepartment" required>
                                <option value="">Select Department</option>
                                <option value="CSE">Computer Science & Engineering</option>
                                <option value="ECE">Electronics & Communication</option>
                                <option value="MECH">Mechanical Engineering</option>
                                <option value="CIVIL">Civil Engineering</option>
                                <option value="IT">Information Technology</option>
                                <option value="PHY">Physics</option>
                                <option value="CHEM">Chemistry</option>
                                <option value="MATH">Mathematics</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label>Capacity *</label>
                            <input type="number" id="labCapacity" required min="1" placeholder="30">
                        </div>
                        
                        <div class="form-group">
                            <label>Floor/Block</label>
                            <input type="text" id="labLocation" placeholder="Block A, Ground Floor">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="labDescription" rows="3" placeholder="Brief description of the laboratory and its purpose"></textarea>
                    </div>
                </div>

                <div class="form-section">
                    <h4><i class="fas fa-user-tie"></i> Lab Management</h4>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label>Lab In-charge</label>
                            <input type="text" id="labIncharge" placeholder="Prof. John Smith">
                        </div>
                        
                        <div class="form-group">
                            <label>Contact Number</label>
                            <input type="tel" id="labContact" placeholder="+91-98765-43210">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label>Lab Assistant</label>
                            <input type="text" id="labAssistant" placeholder="Mr. Tech Support">
                        </div>
                        
                        <div class="form-group">
                            <label>Operating Hours</label>
                            <input type="text" id="operatingHours" placeholder="9:00 AM - 5:00 PM">
                        </div>
                    </div>
                </div>

                <div class="form-section">
                    <h4><i class="fas fa-tools"></i> Equipment & Software</h4>
                    
                    <div class="form-group">
                        <label>Equipment List (one per line)</label>
                        <textarea id="labEquipment" rows="4" placeholder="30 Desktop PCs&#10;1 Projector&#10;1 Whiteboard&#10;Air Conditioning System&#10;UPS Backup"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label>Software Installed (one per line)</label>
                        <textarea id="labSoftware" rows="3" placeholder="Visual Studio 2022&#10;MySQL Workbench&#10;Eclipse IDE&#10;IntelliJ IDEA"></textarea>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label>Safety Equipment</label>
                            <textarea id="safetyEquipment" rows="2" placeholder="Fire Extinguisher, First Aid Kit, Emergency Exit"></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label>Special Features</label>
                            <textarea id="specialFeatures" rows="2" placeholder="Smart Board, Document Camera, Audio System"></textarea>
                        </div>
                    </div>
                </div>

                <div class="form-section">
                    <h4><i class="fas fa-chart-bar"></i> Configuration</h4>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label>Current Utilization (%)</label>
                            <input type="number" id="utilizationRate" min="0" max="100" placeholder="75">
                        </div>
                        
                        <div class="form-group">
                            <label>Status</label>
                            <select id="labStatus">
                                <option value="active">Active</option>
                                <option value="inactive">Inactive</option>
                                <option value="maintenance">Under Maintenance</option>
                                <option value="renovation">Under Renovation</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label>Last Maintenance Date</label>
                            <input type="date" id="lastMaintenance">
                        </div>
                        
                        <div class="form-group">
                            <label>Next Maintenance Due</label>
                            <input type="date" id="nextMaintenance">
                        </div>
                    </div>
                </div>
                
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save"></i>
                        Save Laboratory
                    </button>
                    <button type="button" class="btn btn-secondary" onclick="closeModal()">
                        Cancel
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Lab Booking Modal -->
    <div class="modal" id="labBookingModal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3><i class="fas fa-calendar-plus"></i> Laboratory Booking System</h3>
                <button class="close-btn" onclick="closeModal()">&times;</button>
            </div>
            <div class="booking-content">
                <div class="booking-calendar">
                    <div class="calendar-header">
                        <button class="btn btn-sm btn-secondary" onclick="previousWeek()">
                            <i class="fas fa-chevron-left"></i>
                        </button>
                        <h4 id="calendarWeek">Week of January 15, 2024</h4>
                        <button class="btn btn-sm btn-secondary" onclick="nextWeek()">
                            <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                    <div class="calendar-grid" id="calendarGrid">
                        <!-- Calendar will be populated by JavaScript -->
                    </div>
                </div>
                <div class="booking-form">
                    <h4>Book Laboratory</h4>
                    <form id="bookingForm" onsubmit="saveBooking(event)">
                        <div class="form-group">
                            <label>Select Laboratory *</label>
                            <select id="bookingLab" required>
                                <option value="">Choose a lab</option>
                            </select>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label>Date *</label>
                                <input type="date" id="bookingDate" required>
                            </div>
                            
                            <div class="form-group">
                                <label>Duration *</label>
                                <select id="bookingDuration" required>
                                    <option value="">Select duration</option>
                                    <option value="1">1 Hour</option>
                                    <option value="2">2 Hours</option>
                                    <option value="3">3 Hours</option>
                                    <option value="4">4 Hours</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label>Start Time *</label>
                                <input type="time" id="bookingStartTime" required>
                            </div>
                            
                            <div class="form-group">
                                <label>End Time</label>
                                <input type="time" id="bookingEndTime" readonly>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>Purpose *</label>
                            <input type="text" id="bookingPurpose" required placeholder="Programming Lab Session">
                        </div>
                        
                        <div class="form-group">
                            <label>Faculty In-charge *</label>
                            <input type="text" id="bookingFaculty" required placeholder="Prof. John Smith">
                        </div>
                        
                        <div class="form-group">
                            <label>Expected Students</label>
                            <input type="number" id="expectedStudents" min="1" placeholder="25">
                        </div>
                        
                        <div class="form-group">
                            <label>Special Requirements</label>
                            <textarea id="specialRequirements" rows="3" placeholder="Any special equipment or setup requirements"></textarea>
                        </div>
                        
                        <div class="form-actions">
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-calendar-check"></i>
                                Book Laboratory
                            </button>
                            <button type="button" class="btn btn-secondary" onclick="closeModal()">
                                Cancel
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Lab Details Modal -->
    <div class="modal" id="labDetailsModal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3 id="labDetailsTitle">Laboratory Details</h3>
                <button class="close-btn" onclick="closeModal()">&times;</button>
            </div>
            <div id="labDetailsContent">
                <!-- Lab details will be populated here -->
            </div>
        </div>
    </div>

    <!-- Maintenance Modal -->
    <div class="modal" id="maintenanceModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-tools"></i> Schedule Maintenance</h3>
                <button class="close-btn" onclick="closeModal()">&times;</button>
            </div>
            <form id="maintenanceForm" onsubmit="scheduleMaintenance(event)">
                <div class="form-section">
                    <h4><i class="fas fa-calendar-alt"></i> Maintenance Details</h4>
                    
                    <div class="form-group">
                        <label>Select Laboratory *</label>
                        <select id="maintenanceLab" required>
                            <option value="">Choose a lab</option>
                        </select>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label>Maintenance Type *</label>
                            <select id="maintenanceType" required>
                                <option value="">Select type</option>
                                <option value="routine">Routine Maintenance</option>
                                <option value="repair">Equipment Repair</option>
                                <option value="upgrade">Software Upgrade</option>
                                <option value="cleaning">Deep Cleaning</option>
                                <option value="calibration">Equipment Calibration</option>
                                <option value="emergency">Emergency Repair</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label>Priority *</label>
                            <select id="maintenancePriority" required>
                                <option value="">Select priority</option>
                                <option value="low">Low</option>
                                <option value="medium">Medium</option>
                                <option value="high">High</option>
                                <option value="critical">Critical</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label>Scheduled Date *</label>
                            <input type="date" id="maintenanceDate" required>
                        </div>
                        
                        <div class="form-group">
                            <label>Estimated Duration</label>
                            <select id="maintenanceDuration">
                                <option value="1">1 Hour</option>
                                <option value="2">2 Hours</option>
                                <option value="4">4 Hours</option>
                                <option value="8">8 Hours (Full Day)</option>
                                <option value="24">24 Hours</option>
                                <option value="48">48 Hours</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Assigned Technician</label>
                        <input type="text" id="assignedTech" placeholder="John Doe">
                    </div>
                    
                    <div class="form-group">
                        <label>Description *</label>
                        <textarea id="maintenanceDescription" rows="4" required placeholder="Describe the maintenance work to be performed"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label>Equipment/Items to be serviced</label>
                        <textarea id="equipmentList" rows="3" placeholder="List specific equipment or items that need attention"></textarea>
                    </div>
                </div>
                
                <div class="form-actions">
                    <button type="submit" class="btn btn-warning">
                        <i class="fas fa-tools"></i>
                        Schedule Maintenance
                    </button>
                    <button type="button" class="btn btn-secondary" onclick="closeModal()">
                        Cancel
                    </button>
                </div>
            </form>
        </div>
    </div>

    <div class="notification" id="notification">
        <i class="fas fa-check-circle"></i>
        <span id="notificationText">Success message</span>
    </div>

    <script src="labs.js"></script>
</body>
</html>
